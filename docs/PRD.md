# 疫苗自动分拣传输控制系统 - 产品需求文档 (PRD)

> 文档版本: v1.0.0  
> 更新日期: 2024-12-29  
> 状态: 初稿

---

## 1. 文档概述

### 1.1 文档目的

本文档详细描述疫苗自动分拣传输控制系统（以下简称"本系统"）的产品需求，作为系统设计、开发、测试的依据。

### 1.2 项目背景

随着疫苗接种量的增加，传统人工分拣方式存在以下问题：
- 效率低下，难以满足高峰期需求
- 人工操作易出错，存在安全隐患
- 温控记录不完整，合规性难保证
- 追溯链路不完整，出现问题难追责

本系统旨在通过自动化技术解决上述问题，实现疫苗分拣的智能化、规范化、可追溯化。

### 1.3 术语定义

| 术语 | 定义 |
|------|------|
| 溯源码 | 国家疫苗追溯系统统一编码，20位数字 |
| GSP | 药品经营质量管理规范 (Good Supply Practice) |
| 货道 | 存储特定疫苗的物理通道，采用坐标系统定位 |
| 冷链 | 疫苗从生产到接种全程的温度控制链 |
| HIS | 医院信息系统 (Hospital Information System) |

---

## 2. 产品定位

### 2.1 目标用户

| 用户角色 | 描述 | 核心诉求 |
|----------|------|----------|
| 接种点管理员 | 负责日常运维和设备管理 | 系统稳定、操作简便 |
| 接种护士 | 执行疫苗接种操作 | 快速获取正确疫苗 |
| 疾控管理员 | 远程监管多个接种点 | 实时监控、数据统计 |
| 系统维护员 | 负责系统维护和故障处理 | 故障定位、快速恢复 |

### 2.2 产品愿景

**一句话描述**: 让每一支疫苗都能准确、安全、可追溯地送达接种者。

### 2.3 核心价值主张

```
┌─────────────────────────────────────────────────────────────┐
│                      核心价值主张                            │
├─────────────────┬─────────────────┬─────────────────────────┤
│     安全合规     │     效率提升     │       智能追溯         │
├─────────────────┼─────────────────┼─────────────────────────┤
│ • 全程温控监测   │ • 自动分拣出库   │ • 溯源码全程追踪       │
│ • GSP合规记录   │ • 减少人工干预   │ • 接种记录实时上传     │
│ • 疫苗法遵从    │ • 智能库存预警   │ • 异常事件可追溯       │
└─────────────────┴─────────────────┴─────────────────────────┘
```

---

## 3. 功能需求

### 3.1 功能架构

```
                        ┌────────────────────┐
                        │    疫苗分拣系统     │
                        └─────────┬──────────┘
          ┌───────────────┬───────┴───────┬───────────────┐
          ▼               ▼               ▼               ▼
    ┌───────────┐   ┌───────────┐   ┌───────────┐   ┌───────────┐
    │  分拣管理  │   │  库存管理  │   │  温控管理  │   │  追溯管理  │
    └─────┬─────┘   └─────┬─────┘   └─────┬─────┘   └─────┬─────┘
          │               │               │               │
    ┌─────┴─────┐   ┌─────┴─────┐   ┌─────┴─────┐   ┌─────┴─────┐
    │• 订单接收 │   │• 入库管理 │   │• 温度监测 │   │• 溯源码管理│
    │• 智能分拣 │   │• 出库管理 │   │• 温度预警 │   │• 批次追溯 │
    │• 视觉识别 │   │• 库存盘点 │   │• 温度记录 │   │• 接种关联 │
    │• 传输控制 │   │• 效期预警 │   │• 冷链监控 │   │• 异常追溯 │
    └───────────┘   └───────────┘   └───────────┘   └───────────┘
```

### 3.2 核心功能列表

#### F1: 疫苗入库管理

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F1.1 扫码入库 | P0 | 扫描疫苗溯源码，自动识别疫苗信息 |
| F1.2 批次管理 | P0 | 记录疫苗批次号、生产日期、有效期 |
| F1.3 货位分配 | P0 | 根据疫苗类型自动分配货道位置 |
| F1.4 入库校验 | P0 | 校验疫苗信息与采购订单匹配 |
| F1.5 温度验收 | P0 | 记录入库时的疫苗温度状态 |

#### F2: 智能分拣出库

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F2.1 订单接收 | P0 | 从HIS系统接收接种订单 |
| F2.2 智能拣选 | P0 | 根据FEFO原则自动选择疫苗 |
| F2.3 货道定位 | P0 | 根据坐标系统定位目标货道 |
| F2.4 传输控制 | P0 | 控制皮带线完成疫苗传输 |
| F2.5 视觉复核 | P0 | 出库前进行视觉识别复核 |
| F2.6 异常处理 | P0 | 分拣异常自动报警和处理 |

#### F3: 温度监控管理

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F3.1 实时监测 | P0 | 各货道温度实时采集（间隔≤30秒） |
| F3.2 温度预警 | P0 | 温度越限自动报警（声光+短信） |
| F3.3 温度记录 | P0 | 温度数据自动存储（保存≥5年） |
| F3.4 冷链报表 | P1 | 生成GSP合规的温度报表 |
| F3.5 设备监控 | P1 | 监控制冷设备运行状态 |

#### F4: 库存管理

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F4.1 库存查询 | P0 | 实时查询各疫苗库存数量 |
| F4.2 效期预警 | P0 | 近效期疫苗（≤30天）自动预警 |
| F4.3 库存盘点 | P1 | 支持定期盘点和差异处理 |
| F4.4 安全库存 | P1 | 库存低于阈值自动预警 |
| F4.5 批次追踪 | P0 | 按批次查询疫苗分布和流向 |

#### F5: 追溯管理

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F5.1 溯源码管理 | P0 | 扫描和存储疫苗溯源码 |
| F5.2 追溯查询 | P0 | 根据溯源码查询疫苗全流程 |
| F5.3 接种关联 | P0 | 关联疫苗与接种者信息 |
| F5.4 异常追溯 | P0 | 问题疫苗快速定位追溯 |
| F5.5 数据上报 | P0 | 对接国家疫苗追溯平台 |

#### F6: 远程监控

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F6.1 设备状态 | P0 | 实时显示设备运行状态 |
| F6.2 运行监控 | P0 | 监控分拣任务执行情况 |
| F6.3 报警推送 | P0 | 异常报警实时推送 |
| F6.4 数据统计 | P1 | 运营数据统计分析 |
| F6.5 视频监控 | P2 | 接入现场监控视频 |

#### F7: 系统管理

| 功能点 | 优先级 | 描述 |
|--------|--------|------|
| F7.1 用户管理 | P0 | 用户账号和权限管理 |
| F7.2 角色权限 | P0 | 基于角色的访问控制 |
| F7.3 操作日志 | P0 | 记录所有操作日志 |
| F7.4 系统配置 | P1 | 系统参数配置管理 |
| F7.5 数据备份 | P0 | 自动备份和恢复 |

### 3.3 功能流程图

#### 3.3.1 疫苗出库分拣流程

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│HIS下发  │───▶│订单解析 │───▶│库存检查 │───▶│货道定位 │───▶│PLC指令  │
│接种订单 │    │疫苗信息 │    │批次选择 │    │坐标计算 │    │发送控制 │
└─────────┘    └─────────┘    └─────────┘    └─────────┘    └────┬────┘
                                                                  │
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐         │
│完成分拣 │◀───│出库确认 │◀───│视觉复核 │◀───│皮带传输 │◀────────┘
│更新库存 │    │扫码记录 │    │信息比对 │    │疫苗出库 │
└─────────┘    └─────────┘    └─────────┘    └─────────┘
```

#### 3.3.2 温度监控流程

```
┌──────────────────────────────────────────────────────────────────┐
│                         温度监控流程                              │
└──────────────────────────────────────────────────────────────────┘
         │
         ▼
    ┌─────────┐     ┌─────────────────────────────────────────────┐
    │温度采集 │────▶│                 温度判断                     │
    │(30秒/次)│     │  2℃ ≤ T ≤ 8℃ ?                             │
    └─────────┘     └─────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              │ YES           │               │ NO
              ▼               ▼               ▼
        ┌─────────┐     ┌─────────┐     ┌─────────┐
        │正常记录 │     │预警阈值 │     │越限报警 │
        │数据存储 │     │(±0.5℃) │     │紧急处理 │
        └─────────┘     └────┬────┘     └────┬────┘
                              │               │
                              ▼               ▼
                        ┌─────────┐     ┌─────────┐
                        │提前预警 │     │声光报警 │
                        │趋势分析 │     │短信通知 │
                        └─────────┘     │停止出库 │
                                        └─────────┘
```

---

## 4. 非功能需求

### 4.1 性能需求

| 指标 | 要求 | 说明 |
|------|------|------|
| 日处理能力 | 200-1000支/天 | 满足中型接种点需求 |
| 单次分拣时间 | ≤15秒 | 从订单接收到出库完成 |
| 识别准确率 | ≥99.9% | 视觉识别+扫码双重验证 |
| 系统响应时间 | ≤100ms | 用户操作响应 |
| 数据同步延迟 | ≤1秒 | 本地与云端数据同步 |
| 并发用户数 | ≥50 | 远程监控并发访问 |

### 4.2 可靠性需求

| 指标 | 要求 | 实现方式 |
|------|------|----------|
| 系统可用性 | ≥99.95% | 关键组件冗余设计 |
| 平均故障间隔 | ≥2000小时 | 高质量元器件选型 |
| 故障恢复时间 | ≤5分钟 | 自动故障检测和切换 |
| 数据持久性 | 99.999999% | 多副本+异地备份 |

### 4.3 安全需求

| 类别 | 要求 |
|------|------|
| 身份认证 | 支持用户名密码+短信验证码双因素认证 |
| 访问控制 | 基于RBAC的细粒度权限控制 |
| 数据加密 | 传输加密(TLS1.3)，存储加密(AES-256) |
| 审计日志 | 所有操作可追溯，日志保存≥5年 |
| 网络安全 | 支持内网隔离，外网访问需VPN |

### 4.4 兼容性需求

| 类别 | 要求 |
|------|------|
| 操作系统 | Windows 10/11 (本地控制台) |
| 浏览器 | Chrome 90+, Edge 90+, Firefox 90+ |
| PLC兼容 | 信捷XC/XD系列 |
| 数据库 | PostgreSQL 15+, Redis 7+ |
| HIS对接 | HL7 FHIR / REST API / WebService |

### 4.5 合规性需求

| 法规/标准 | 要求 |
|-----------|------|
| 《疫苗管理法》 | 符合疫苗储存、运输、追溯相关规定 |
| GSP规范 | 满足冷链温控记录、设备验证等要求 |
| 追溯平台 | 对接国家疫苗追溯协同平台 |
| 等保要求 | 达到信息系统安全等级保护二级 |
| 医疗器械软件 | 符合医疗器械软件生命周期要求 |

---

## 5. 用户界面需求

### 5.1 本地控制台 (WinForms)

#### 5.1.1 主界面布局

```
┌─────────────────────────────────────────────────────────────────┐
│ [Logo] 疫苗分拣控制系统                    [用户] [设置] [帮助] │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────┐ ┌─────────────────────────────────────────────────┐ │
│ │         │ │                                                 │ │
│ │  设备   │ │                  货道矩阵视图                   │ │
│ │  状态   │ │                                                 │ │
│ │  面板   │ │    [A1][A2][A3][A4][A5][A6][A7][A8][A9][A10]   │ │
│ │         │ │    [B1][B2][B3][B4][B5][B6][B7][B8][B9][B10]   │ │
│ │ ┌─────┐ │ │    [C1][C2][C3][C4][C5][C6][C7][C8][C9][C10]   │ │
│ │ │ PLC │ │ │    [D1][D2][D3][D4][D5][D6][D7][D8][D9][D10]   │ │
│ │ │ ●在线│ │ │    [E1][E2][E3][E4][E5][E6][E7][E8][E9][E10]   │ │
│ │ └─────┘ │ │    [F1][F2][F3][F4][F5][F6][F7][F8][F9][F10]   │ │
│ │ ┌─────┐ │ │                                                 │ │
│ │ │温度 │ │ │    ████████████ 皮带传输线 ████████████         │ │
│ │ │5.2℃│ │ │                      ↓                          │ │
│ │ └─────┘ │ │                 [出库口]                        │ │
│ └─────────┘ └─────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────┐ ┌─────────────────────────────┐ │
│ │      当前任务队列            │ │       操作记录              │ │
│ │ ─────────────────────────── │ │ ─────────────────────────── │ │
│ │ #001 乙肝疫苗 B3 → 出库口   │ │ 10:32:15 A2出库 乙肝疫苗    │ │
│ │ #002 流感疫苗 C5 → 出库口   │ │ 10:31:42 C3出库 流感疫苗    │ │
│ │ #003 狂犬疫苗 A8 → 出库口   │ │ 10:30:58 入库完成 批次B2024 │ │
│ └─────────────────────────────┘ └─────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ 状态: 运行中 | 今日出库: 156支 | 队列: 3 | 温度: 5.2℃ 正常    │
└─────────────────────────────────────────────────────────────────┘
```

#### 5.1.2 界面色彩规范

| 元素 | 颜色 | 用途 |
|------|------|------|
| 主色调 | #1976D2 (蓝) | 标题栏、按钮 |
| 成功状态 | #4CAF50 (绿) | 正常、完成 |
| 警告状态 | #FF9800 (橙) | 预警、注意 |
| 错误状态 | #F44336 (红) | 错误、越限 |
| 背景色 | #F5F5F5 (灰) | 主背景 |

### 5.2 远程监控 (Web)

#### 5.2.1 仪表盘布局

```
┌─────────────────────────────────────────────────────────────────┐
│  🏥 疫苗分拣监控中心                    [通知🔔] [用户▼] [退出] │
├───────┬─────────────────────────────────────────────────────────┤
│       │  ┌───────────┐ ┌───────────┐ ┌───────────┐ ┌─────────┐ │
│ 导航  │  │ 今日出库   │ │ 库存总量   │ │ 当前温度   │ │系统状态 │ │
│       │  │   156     │ │   2,340   │ │   5.2℃   │ │  ●正常  │ │
│ ○仪表盘│  │   ↑12%    │ │   60种    │ │   正常    │ │ 99.9%  │ │
│ ○任务  │  └───────────┘ └───────────┘ └───────────┘ └─────────┘ │
│ ○库存  │ ┌─────────────────────────────────────────────────────┐ │
│ ○温控  │ │                    温度趋势图                        │ │
│ ○追溯  │ │  8°C ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ 上限    │ │
│ ○报表  │ │      ╱╲    ╱╲                                       │ │
│ ○设置  │ │  5°C ╱  ╲╱  ╲╱───────────────────────────           │ │
│       │ │  2°C ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ 下限    │ │
│       │ │      08:00  10:00  12:00  14:00  16:00              │ │
│       │ └─────────────────────────────────────────────────────┘ │
│       │ ┌────────────────────────┐ ┌──────────────────────────┐ │
│       │ │     出库任务列表        │ │      报警信息            │ │
│       │ │ ───────────────────── │ │ ────────────────────────│ │
│       │ │ ● 进行中 乙肝疫苗 B3   │ │ ⚠ 10:15 A区温度接近上限 │ │
│       │ │ ○ 等待中 流感疫苗 C5   │ │ ✓ 09:30 已处理 设备重启 │ │
│       │ └────────────────────────┘ └──────────────────────────┘ │
└───────┴─────────────────────────────────────────────────────────┘
```

---

## 6. 数据需求

### 6.1 核心数据实体

| 实体 | 说明 | 数据量预估 |
|------|------|------------|
| 疫苗信息 | 疫苗基础信息 | 60条 |
| 库存记录 | 当前库存明细 | 2000条 |
| 入库记录 | 历史入库 | 10000条/年 |
| 出库记录 | 历史出库 | 50000条/年 |
| 温度记录 | 温度采集数据 | 100万条/年 |
| 追溯记录 | 疫苗追溯链 | 50000条/年 |
| 操作日志 | 系统操作日志 | 100万条/年 |

### 6.2 数据保留策略

| 数据类型 | 保留期限 | 存储方式 |
|----------|----------|----------|
| 温度记录 | 5年 | 热数据1年+冷存储4年 |
| 追溯记录 | 永久 | 热数据3年+归档 |
| 操作日志 | 5年 | 热数据1年+冷存储4年 |
| 业务数据 | 永久 | 定期归档 |

### 6.3 数据接口

#### 6.3.1 HIS系统对接

```json
// 接种订单推送 (HIS → 本系统)
{
  "orderId": "ORD202412290001",
  "patientId": "P123456",
  "vaccineCode": "VAC001",
  "vaccineName": "乙肝疫苗",
  "doseNumber": 1,
  "orderTime": "2024-12-29T10:30:00",
  "priority": "normal"
}

// 出库确认回传 (本系统 → HIS)
{
  "orderId": "ORD202412290001",
  "traceCode": "20241229001234567890",
  "batchNumber": "B20241201",
  "expiryDate": "2025-12-01",
  "outboundTime": "2024-12-29T10:30:15",
  "temperature": 5.2,
  "status": "success"
}
```

#### 6.3.2 国家追溯平台对接

按照《疫苗追溯基本数据集》标准格式上报。

---

## 7. 约束与假设

### 7.1 约束条件

| 约束 | 说明 |
|------|------|
| 硬件选型 | 必须使用信捷PLC |
| 网络环境 | 本地控制台与PLC在同一局域网 |
| 操作系统 | 本地控制台需Windows环境 |
| 冷链要求 | 疫苗存储温度必须在2-8℃ |
| 合规要求 | 必须满足GSP和疫苗法要求 |

### 7.2 假设条件

| 假设 | 说明 |
|------|------|
| 网络稳定 | 假设内网环境稳定可靠 |
| 电力保障 | 假设配备UPS不间断电源 |
| 培训到位 | 假设操作人员经过培训 |
| 疫苗规范 | 假设疫苗入库时已贴溯源码 |

---

## 8. 验收标准

### 8.1 功能验收

| 验收项 | 验收标准 |
|--------|----------|
| 入库功能 | 100支疫苗入库无错误 |
| 出库功能 | 连续100次出库准确率100% |
| 温控功能 | 24小时温度采集无中断 |
| 追溯功能 | 任意疫苗可追溯完整链路 |
| HIS对接 | 订单处理成功率≥99.9% |

### 8.2 性能验收

| 验收项 | 验收标准 |
|--------|----------|
| 分拣效率 | 单支分拣≤15秒 |
| 识别准确率 | ≥99.9% |
| 系统响应 | ≤100ms |
| 稳定性 | 连续运行7×24小时无故障 |

### 8.3 合规验收

- [ ] 通过GSP认证检查
- [ ] 通过疫苗追溯平台对接测试
- [ ] 通过信息安全等保二级评测
- [ ] 通过医疗器械软件注册审查

---

## 9. 里程碑

| 阶段 | 时间 | 交付物 |
|------|------|--------|
| 需求确认 | 第1-2周 | PRD定稿 |
| 架构设计 | 第3-4周 | 架构设计文档 |
| 原型开发 | 第5-8周 | 可演示原型 |
| 功能开发 | 第9-16周 | Alpha版本 |
| 集成测试 | 第17-20周 | Beta版本 |
| 试运行 | 第21-24周 | RC版本 |
| 正式上线 | 第25周 | v1.0正式版 |

---

## 附录

### A. 疫苗规格清单（60种）

详见《疫苗规格清单.xlsx》

### B. 货道坐标定义

- 坐标系: 6行×10列矩阵
- 命名规则: {行字母}{列数字}，如A1, B5, F10
- 每个货道存储单一规格疫苗

### C. 参考文档

1. 《中华人民共和国疫苗管理法》
2. 《药品经营质量管理规范》
3. 《疫苗追溯基本数据集》
4. 《信捷XC系列PLC编程手册》

---

> 文档审批：
> - 产品经理: __________ 日期: __________
> - 技术负责人: __________ 日期: __________
> - 项目经理: __________ 日期: __________

